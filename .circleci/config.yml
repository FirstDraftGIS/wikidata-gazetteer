version: 2
jobs:
    build:
        docker:
            - image: python:latest
        steps:
            - checkout
            - run:
                name: install dependencies
                command: |
                    python3 -m venv venv
                    . venv/bin/activate
                    pip install -r requirements.txt      
            - run:
                name: create gazetteer
                command: |
                    . venv/bin/activate
                    python3 create_gazetteer_from_wikidata.py         
            - run:
                name: run tests
                command: echo "will write tests later"
            - run:
                name: Install AWS CLI
                command: pip install awscli --upgrade
            - run:
                name: copy into s3 bucket
                command: aws s3 cp /tmp/wikidata-gazetteer.csv s3://firstdraftgis/wikidata-gazetter.csv
